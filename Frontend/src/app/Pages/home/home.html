<div class="home-container">
  <div class="hero-section">
    <div class="hero-slider">
      <div
        class="slide"
        *ngFor="let slide of slides; let i = index"
        [class.active]="i === currentSlide"
      >
        <img [src]="slide.image" alt="Hero Image" />
      </div>
    </div>

    <div class="hero-content">
      <h1>Find Your Perfect Stay</h1>
      <p>Discover amazing properties in the most beautiful locations</p>

      <form
        #searchForm="ngForm"
        class="search-form"
        (ngSubmit)="applySearchFilters()"
      >
        <div class="search-row">
          <div class="form-group">
            <label for="village" class="form-label">Location</label>
            <select
              id="village"
              name="village"
              [(ngModel)]="selectedVillage"
              class="form-select"
            >
              <option value="">Any Location</option>
              <option *ngFor="let village of villages" [value]="village">
                {{ village }}
              </option>
            </select>
          </div>

          <div class="form-group">
            <label for="type" class="form-label">Property Type</label>
            <select
              id="type"
              name="type"
              [(ngModel)]="selectedType"
              class="form-select"
            >
              <option value="">Any Type</option>
              <option *ngFor="let type of unitTypes" [value]="type">
                {{ type }}
              </option>
            </select>
          </div>

          <div class="form-group">
            <label for="bedrooms" class="form-label">Bedrooms</label>
            <select
              id="bedrooms"
              name="bedrooms"
              [(ngModel)]="selectedBedrooms"
              class="form-select"
            >
              <option value="">Any</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4+">4+</option>
            </select>
          </div>

          <div class="form-group">
            <label for="bathrooms" class="form-label">Bathrooms</label>
            <select
              id="bathrooms"
              name="bathrooms"
              [(ngModel)]="selectedBathrooms"
              class="form-select"
            >
              <option value="">Any</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3+">3+</option>
            </select>
          </div>

          <button
            type="submit"
            class="btn btn-primary btn-search"
            [disabled]="isLoading || isSearching || !isSearchValid()"
            [class.btn-loading]="isSearching"
          >
            <i class="fas fa-search me-2"></i>
            <span *ngIf="!isSearching">SEARCH</span>
            <span *ngIf="isSearching">SEARCHING...</span>
          </button>
        </div>

        <div class="more-options">
          <a
            href="#"
            class="more-options-link"
            (click)="toggleMoreOptions($event)"
          >
            <i class="fas fa-sliders-h me-2"></i>
            Show/Hide Advanced Options
          </a>
        </div>

        <div
          *ngIf="searchPerformed && !isSearchValid()"
          class="alert alert-warning mt-3"
        >
          <i class="fas fa-exclamation-triangle me-2"></i>
          Please select at least one search criteria and ensure all values are
          valid.
        </div>

        <div *ngIf="showMoreOptions" class="advanced-options">
          <div class="form-row">
            <div class="form-group">
              <label for="minPrice" class="form-label">Min Price</label>
              <input
                id="minPrice"
                type="number"
                name="minPrice"
                [(ngModel)]="minPrice"
                class="form-control"
                placeholder="Min Price"
                min="0"
                step="0.01"
              />
            </div>

            <div class="form-group">
              <label for="maxPrice" class="form-label">Max Price</label>
              <input
                id="maxPrice"
                type="number"
                name="maxPrice"
                [(ngModel)]="maxPrice"
                class="form-control"
                placeholder="Max Price"
                min="0"
                step="0.01"
              />
            </div>
          </div>
        </div>

        <div
          *ngIf="searchPerformed && hasActiveFilters()"
          class="search-summary mt-3"
        >
          <i class="fas fa-filter me-2"></i>
          <strong>Active Filters:</strong> {{ getSearchSummary() }}
        </div>
      </form>
    </div>
  </div>

  <div class="container mt-5">
    <div class="section-header text-center mb-5">
      <h2 *ngIf="!searchPerformed">
        Discover our hand-picked selection of premium properties
      </h2>
      <h2 *ngIf="searchPerformed && hasActiveFilters()">
        Showing {{ getFilteredUnitsCount() }} of {{ getTotalUnitsCount() }}
        properties
        <button
          class="btn btn-outline-secondary btn-sm ms-3"
          (click)="clearFilters()"
        >
          <i class="fas fa-times me-1"></i>Clear Filters
        </button>
      </h2>
    </div>

    <div *ngIf="isLoading" class="text-center py-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-2">Loading properties...</p>
    </div>

    <div *ngIf="error" class="alert alert-danger text-center" role="alert">
      <i class="fas fa-exclamation-triangle me-2"></i>
      {{ error }}
      <button class="btn btn-outline-danger btn-sm ms-3" (click)="fetchUnits()">
        <i class="fas fa-redo me-1"></i>Try Again
      </button>
    </div>

    <div *ngIf="!isLoading && !error" class="properties-section">
      <div class="properties-carousel">
        <div
          class="carousel-header d-flex justify-content-between align-items-center mb-4"
        >
          <h3>Latest Properties</h3>
          <div class="carousel-controls">
            <button
              class="btn btn-outline-primary btn-sm"
              (click)="previousPropertyPage()"
              [disabled]="currentPropertyPage === 0"
            >
              <i class="fas fa-chevron-left"></i>
            </button>
            <span class="mx-3">
              {{ currentPropertyPage + 1 }} of {{ totalPropertyPages }}
            </span>
            <button
              class="btn btn-outline-primary btn-sm"
              (click)="nextPropertyPage()"
              [disabled]="currentPropertyPage >= totalPropertyPages - 1"
            >
              <i class="fas fa-chevron-right"></i>
            </button>
          </div>
        </div>

        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
          <div class="col" *ngFor="let unit of paginatedUnits">
            <div
              class="property-card"
              (click)="viewUnitDetails(unit.id)"
              (keydown.enter)="viewUnitDetails(unit.id)"
              (keydown.space)="viewUnitDetails(unit.id)"
              tabindex="0"
              role="button"
              [attr.aria-label]="'View details for ' + unit.title"
              style="cursor: pointer"
            >
              <div class="property-image-container">
                <img
                  [src]="getUnitImagePath(unit)"
                  class="property-image"
                  alt="Property Image"
                  (error)="onImageError($event)"
                />
                <div class="property-status">
                  <span class="badge bg-success">Available</span>
                </div>
              </div>

              <div class="property-body">
                <h5 class="property-title">{{ unit.title }}</h5>
                <p class="property-address">
                  <i class="fas fa-map-marker-alt me-2"></i>
                  {{ unit.address }}, {{ unit.villageName }}
                </p>
                <p class="property-price">
                  EGP {{ unit.basePricePerNight | number:'1.2-2' }} / night
                </p>

                <div class="property-details">
                  <div>
                    <i class="fas fa-bed me-1"></i> {{ unit.bedrooms }} Beds
                  </div>
                  <div>
                    <i class="fas fa-bath me-1"></i> {{ unit.bathrooms }} Baths
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div
          *ngIf="searchPerformed && paginatedUnits.length === 0"
          class="text-center py-5"
        >
          <div class="no-results">
            <i class="fas fa-search fa-3x text-muted mb-3"></i>
            <h4 class="text-muted">No Properties Found</h4>
            <p class="text-muted">
              Try adjusting your search criteria to find more properties.
            </p>
            <button class="btn btn-primary" (click)="clearFilters()">
              <i class="fas fa-redo me-2"></i>Clear Filters
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="how-it-works-section">
    <div class="container">
      <div class="section-header text-center mb-5">
        <h2>How It Works</h2>
        <p class="text-muted">
          Simple steps to find your perfect accommodation
        </p>
      </div>

      <div class="row g-4">
        <div class="col-md-4">
          <div class="step-card text-center">
            <div class="step-icon">
              <i class="fas fa-search fa-2x"></i>
            </div>
            <h4>Search</h4>
            <p>
              Browse through our extensive collection of properties using
              advanced filters
            </p>
          </div>
        </div>

        <div class="col-md-4">
          <div class="step-card text-center">
            <div class="step-icon">
              <i class="fas fa-calendar-check fa-2x"></i>
            </div>
            <h4>Book</h4>
            <p>
              Select your preferred dates and complete your booking securely
            </p>
          </div>
        </div>

        <div class="col-md-4">
          <div class="step-card text-center">
            <div class="step-icon">
              <i class="fas fa-home fa-2x"></i>
            </div>
            <h4>Enjoy</h4>
            <p>Arrive at your chosen property and enjoy your perfect stay</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="cta-section">
    <div class="container text-center">
      <h2>Ready to Find Your Perfect Stay?</h2>
      <p class="lead">
        Join thousands of satisfied guests who found their ideal accommodation
      </p>
      <a href="/units" class="btn btn-primary btn-lg">
        <i class="fas fa-search me-2"></i>Browse All Properties
      </a>
    </div>
  </div>
</div>
