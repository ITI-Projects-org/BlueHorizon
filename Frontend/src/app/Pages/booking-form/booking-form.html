<!-- Modal Overlay -->
<div *ngIf="isVisible" class="modal-overlay" (click)="closeModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h4>Book This Unit</h4>
      <button type="button" class="close-btn" (click)="closeModal()">Ã—</button>
    </div>

    <div class="modal-body">
      <!-- Error Message -->
      <div *ngIf="errorMessage" class="alert alert-danger">
        {{ errorMessage }}
      </div>

      <!-- Booking Form -->
      <form [formGroup]="bookingForm" (ngSubmit)="onSubmit()">
        <!-- Check-in Date -->
        <div class="form-group mb-3">
          <label for="checkInDate" class="form-label">Check-in Date</label>
          <input
            type="date"
            id="checkInDate"
            class="form-control"
            formControlName="checkInDate"
            [min]="today"
            [class.is-invalid]="checkInDate?.invalid && checkInDate?.touched"
          />
          <div
            *ngIf="checkInDate?.invalid && checkInDate?.touched"
            class="invalid-feedback"
          >
            <div *ngIf="checkInDate?.errors?.['required']">
              Check-in date is required
            </div>
          </div>
        </div>

        <!-- Check-out Date -->
        <div class="form-group mb-3">
          <label for="checkOutDate" class="form-label">Check-out Date</label>
          <input
            type="date"
            id="checkOutDate"
            class="form-control"
            formControlName="checkOutDate"
            [min]="checkInDate?.value || tomorrow"
            [class.is-invalid]="checkOutDate?.invalid && checkOutDate?.touched"
          />
          <div
            *ngIf="checkOutDate?.invalid && checkOutDate?.touched"
            class="invalid-feedback"
          >
            <div *ngIf="checkOutDate?.errors?.['required']">
              Check-out date is required
            </div>
          </div>
        </div>

        <!-- Number of Guests -->
        <div class="form-group mb-3">
          <label for="numberOfGuests" class="form-label"
            >Number of Guests</label
          >
          <input
            type="number"
            id="numberOfGuests"
            class="form-control"
            formControlName="numberOfGuests"
            min="1"
            max="20"
            [class.is-invalid]="numberOfGuests?.invalid && numberOfGuests?.touched"
          />
          <div
            *ngIf="numberOfGuests?.invalid && numberOfGuests?.touched"
            class="invalid-feedback"
          >
            <div *ngIf="numberOfGuests?.errors?.['required']">
              Number of guests is required
            </div>
            <div *ngIf="numberOfGuests?.errors?.['min']">
              At least 1 guest is required
            </div>
            <div *ngIf="numberOfGuests?.errors?.['max']">
              Maximum 20 guests allowed
            </div>
          </div>
        </div>

        <!-- Form Actions -->
        <div class="form-actions">
          <button
            type="button"
            class="btn btn-secondary me-2"
            (click)="closeModal()"
            [disabled]="isSubmitting"
          >
            Cancel
          </button>
          <button
            type="submit"
            class="btn btn-primary"
            [disabled]="bookingForm.invalid || isSubmitting"
          >
            <span
              *ngIf="isSubmitting"
              class="spinner-border spinner-border-sm me-2"
            ></span>
            {{ isSubmitting ? 'Booking...' : 'Book Now' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
